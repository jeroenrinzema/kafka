# MirrorMaker 2 Configuration
# This configuration sets up replication from source to destination cluster

# Cluster definitions
clusters = source, destination

# Source cluster connection
source.bootstrap.servers = kafka-source:19092
source.group.id = mirrormaker2-source

# Destination cluster connection
destination.bootstrap.servers = kafka-destination:19093
destination.group.id = mirrormaker2-destination

# Enable replication from source to destination
source->destination.enabled = true

# Topics to replicate (regex pattern)
# Use .* to replicate all topics, or specify patterns like: orders|payments|users
source->destination.topics = .*

# Exclude internal and system topics
source->destination.topics.exclude = .*[\-\.]internal, .*\.replica, __.*

# Replication settings
replication.factor = 1
checkpoints.topic.replication.factor = 1
heartbeats.topic.replication.factor = 1
offset-syncs.topic.replication.factor = 1
offset.storage.replication.factor = 1
status.storage.replication.factor = 1
config.storage.replication.factor = 1

# Sync consumer groups and their offsets
sync.group.offsets.enabled = true
sync.group.offsets.interval.seconds = 60
emit.checkpoints.enabled = true
emit.checkpoints.interval.seconds = 60

# Emit heartbeats to track replication health
emit.heartbeats.enabled = true
emit.heartbeats.interval.seconds = 5

# Number of tasks for parallel processing
tasks.max = 1

# Refresh topics and partitions configuration
refresh.topics.enabled = true
refresh.topics.interval.seconds = 60
refresh.groups.enabled = true
refresh.groups.interval.seconds = 60

# Topic naming convention
replication.policy.class = org.apache.kafka.connect.mirror.DefaultReplicationPolicy
replication.policy.separator = .

# Performance tuning
producer.max.in.flight.requests.per.connection = 1
producer.batch.size = 16384
producer.linger.ms = 100
producer.compression.type = snappy
producer.acks = all

# Consumer settings
consumer.max.poll.records = 500
consumer.max.poll.interval.ms = 300000
consumer.session.timeout.ms = 30000

# Connector settings
connector.class = org.apache.kafka.connect.mirror.MirrorSourceConnector
key.converter = org.apache.kafka.connect.converters.ByteArrayConverter
value.converter = org.apache.kafka.connect.converters.ByteArrayConverter
header.converter = org.apache.kafka.connect.converters.ByteArrayConverter
